<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>How to create a Microsoft DNS Dynamic Types plug-in ? - vCO Team</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="On the 1 I have explained how vRealize Automation Anything as a Service (XaaS) work with Orchestrator and how a vRO plug-in works.In this tutorial I will walk you through how I managed to implement Microsoft DNS as a service I used for the screenshot examples on that blog including:- The Microsoft DNS dynamic types plug-in- DNS record as a service in vRA- DNS record as a blueprint component. This is the first public tutorial on how to create a Dynamic Types plug-in from scratch and the overall methodology used applies to other integrations.">
		<meta property="og:title" content="How to create a Microsoft DNS Dynamic Types plug-in ?" />
<meta property="og:description" content="On the 1 I have explained how vRealize Automation Anything as a Service (XaaS) work with Orchestrator and how a vRO plug-in works.In this tutorial I will walk you through how I managed to implement Microsoft DNS as a service I used for the screenshot examples on that blog including:- The Microsoft DNS dynamic types plug-in- DNS record as a service in vRA- DNS record as a blueprint component. This is the first public tutorial on how to create a Dynamic Types plug-in from scratch and the overall methodology used applies to other integrations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.vcoteam.info/articles/learn-vco/323-how-to-create-a-microsoft-dns-dynamic-types-plug-in.html" /><meta property="article:section" content="articles" />
<meta property="article:published_time" content="2017-10-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2017-10-18T00:00:00&#43;00:00" />


		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to create a Microsoft DNS Dynamic Types plug-in ?"/>
<meta name="twitter:description" content="On the 1 I have explained how vRealize Automation Anything as a Service (XaaS) work with Orchestrator and how a vRO plug-in works.In this tutorial I will walk you through how I managed to implement Microsoft DNS as a service I used for the screenshot examples on that blog including:- The Microsoft DNS dynamic types plug-in- DNS record as a service in vRA- DNS record as a blueprint component. This is the first public tutorial on how to create a Dynamic Types plug-in from scratch and the overall methodology used applies to other integrations."/>

	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.min.css">
	<link rel="shortcut icon" href="/images/vco-logo.png">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-16400053-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="vCO Team" rel="home">
			<div class="logo__item logo__imagebox">
					<img alt="vCO Team avatar" class="logo__img" src="https://www.vcoteam.info/images/vco-logo.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">vCO Team</div>
					
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/articles/home-lab.html">
				
				<span class="menu__text">Home Lab</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/articles/learn-vco.html">
				
				<span class="menu__text">Learn VCO</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/links.html">
				
				<span class="menu__text">Links</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/articles/newsflash.html">
				
				<span class="menu__text">newsflash</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/question-answer.html">
				
				<span class="menu__text">Q&amp;A</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/articles/vco-features.html">
				
				<span class="menu__text">vCO Features</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
  <article class="post">
    <header class="post__header">
      <h1 class="post__title">How to create a Microsoft DNS Dynamic Types plug-in ?</h1>
      <div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2017-10-18T00:00:00Z">October 18, 2017</time></div>
</div>
    </header><div class="content post__content clearfix">
      <p>On the <a href="https://blogs.vmware.com/orchestrator/?p=780"  target="_blank" rel="noreferrer noopener" >VMware blog</a> I have explained how vRealize Automation Anything as a Service (XaaS) work with Orchestrator and how a vRO plug-in works.</p>
<p>In this tutorial I will walk you through how I managed to implement Microsoft DNS as a service I used for the screenshot examples on that blog including:</p>
<ul>
<li>The Microsoft DNS dynamic types plug-in</li>
<li>DNS record as a service in vRA</li>
<li>DNS record as a blueprint component</li>
</ul>
<p>This is the first public tutorial on how to create a Dynamic Types plug-in from scratch and the overall methodology used applies to other integrations.</p>
<h2 id="creating-a-microsoft-dns-plug-in">Creating a Microsoft DNS plug-in</h2>
<h3 id="-1--the-name-space">-1- The name space</h3>
<p>First you need to run the &ldquo;Define Namespace&rdquo; workflow.</p>
<p>If you look at the plug-in inventory you will notice that Dynamic Types as a root element. All the namespaces you will create will be listed under this root element. The name should define your plug-in. In my case &ldquo;Microsoft DNS&rdquo;. This name will be used to prefix the type of your plug-in objects. For example &ldquo;DynamicTypes:Microsoft DNS.zone&rdquo;
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-002.png"/> <figcaption>
            <h4>The Dynamic Types namespaces</h4>
        </figcaption>
</figure>
</p>
<h2 id="-2--creating-the-types">-2- Creating the types</h2>
<p>Then you need to think about what objects you need in your inventory. This includes the parent folders and the objects. In my case:</p>
<ul>
<li>Hosts : The parent folder containing all my DNS servers</li>
<li>Host : The DNS servers</li>
<li>Zones : the zones parent folders (I.E Forward lookup Zones, Reverse lookup Zones)</li>
<li>Zone : the zones</li>
<li>resourceRecords : the DNS records</li>
</ul>
<p>This is my implementation but I could for example have decided to have different types for the zones parent folders, the zones (i.E forwardZone and reverseZone) and the records depending on their different types.</p>
<p>To adjust which type I needed I did a little bit of research checking the Microsoft DNS user interface and most importantly the Microsoft DNS API which is Powershell based. When I saw that for example that I could query all zones types and they returned the same properties I decided on this design with one object.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-001.png"/> <figcaption>
            <h4>Microsoft DNS manager</h4>
        </figcaption>
</figure>
</p>
<p>Exploring the user interface and what the API can return for the different object is also important to determine what properties you want the object to have in vRO. If these properties are in the UI or returned by the PowerShell cmdlts this must be for a good reason. In my case I looked at the results of get-dnsServerZone and get-dnsServerResourceRecord.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-003.png"/> <figcaption>
            <h4>Checking the properties returned by the API call. Micorsoft DNS has a PowerShell API.</h4>
        </figcaption>
</figure>
</p>
<p>You do not necessary have to know all the objects and their properties beforehand since you can always update these after but it will save you some time in the implementation.</p>
<p>Once you have your types listed and their important properties you can run the &ldquo;Define Type&rdquo; workflow for each type. You may want to do a bit or prep work before :</p>
<ul>
<li>Besides the name of the type you have to provide the object properties and an icon for the inventory. You can either select one of the default icon in the library or do some icon captures and import these in vRO as resource elements. If you choose for the former you can always update the types after to change the icons.</li>
<li>The Define Type workflow will also ask you if you want to generate workflow stubs for the find and hasChildrenInRelation methods. You will also have to provide a workflow category for these. In my case I created a &ldquo;Plug-in methods&rdquo; category under a Microsoft DNS category.</li>
</ul>
<p>I highly recommend using workflow stubs. The reason is that when you will test the plug-in you will see the workflow runs which will help you understand when the methods are called and see if they are successful or not.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-004.png"/> <figcaption>
            <h4>Workflow stubs created by the &#39;Define Type&#39; workflow</h4>
        </figcaption>
</figure>
</p>
<h2 id="-3--creating-the-relations">-3- Creating the relations</h2>
<p>Now that we have objects we need to establish the parent to child relationships. This will create the inventory tree-view and call the hasChildrenInRelation and findRelation workflows when unfolding it.</p>
<p>Run the &ldquo;Define Relation&rdquo;. For relation name I always put [parentType]-[childType]. For example &ldquo;hosts-host&rdquo;.</p>
<p>Once done check the result under Dynamic Types / Type Hierarchy.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-005.png"/> <figcaption>
            <h4>Type hierarchy as created by the &#39;Define relation&#39; workflow</h4>
        </figcaption>
</figure>
</p>
<p>Now we need to implement the HasChildrenInRelation and findRelation methods for each object to be able to unfold the inventory under the namespace.</p>
<h2 id="-4--implementing-the-haschildreninrelation-methods">-4- Implementing the HasChildrenInRelation methods</h2>
<p>Since we know every object will have children except the resourceRecord we can edit all the &ldquo;Has Microsoft DNS-[objectName]&rdquo; workflows scriptable task with result = true; and the &ldquo;Has Microsoft DNS-resourceRecord&rdquo; with result = false;
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-006.png"/> <figcaption>
            <h4>Editing Has Children In Relation</h4>
        </figcaption>
</figure>
</p>
<h2 id="-5--implementing-the-findrelation-methods">-5- Implementing the findRelation methods.</h2>
<p>If you look at the findRelation workflow stubs you will see the workflow receive 3 inputs :</p>
<ul>
<li>parentType</li>
<li>parentId</li>
<li>relationName</li>
</ul>
<p>Lets implement the Find Relation workflow for each type.</p>
<h3 id="find-relation-microsoft-dns-hosts">Find Relation Microsoft DNS-hosts</h3>
<p>There is something specific with the first object and its child relation under the Dynamic Types level : This same workflow will be called when unfolding the namespace to display the root folder &ldquo;Hosts&rdquo; and when unfolding the &ldquo;Hosts&rdquo; folder.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-008.png"/> <figcaption>
            <h4>Find Relation Microsoft DNS-hosts is called to display these two levels</h4>
        </figcaption>
</figure>
</p>
<p>In order to determine what we need to return we are going to check relationName this way:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">relationName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;namespace-children&#34;</span>) {
  <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">findAllMicrosoftDNSHosts</span>(<span style="color:#e6db74">&#34;hosts&#34;</span>);
}

<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">relationName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;hosts-host&#34;</span>) {
  <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">findAllMicrosoftDNSHost</span>(<span style="color:#e6db74">&#34;host&#34;</span>);
}
</code></pre></td></tr></table>
</div>
</div><p>Note that:</p>
<ul>
<li>The name of the namespace to hosts relation name is predefined in the plug-in as &ldquo;namespace-children&rdquo;</li>
<li>I have created a com.vmware.coe.microsoft.dns.dt scripting module where I created findAllDNS* actions that I am calling here since for these particular objects findRelation returns the same objects as findAll.</li>
<li>The goal of the workflow is to return the resultObjs objects of typeArray/DynamicTypes:DynamicObject which is the generic object type for DynamicTypes object</li>
</ul>
<p>Now lets have a look at the actions:Array/DynamicTypes:Microsoft DNS.hosts findAllMicrosoftDNSHosts(type)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
<span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;hosts&#34;</span>, <span style="color:#e6db74">&#34;DNS&#34;</span>, <span style="color:#e6db74">&#34;DNS&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
</code></pre></td></tr></table>
</div>
</div><p>We are basically calling the DynamicTypesManager makeObject method with passing the namespace, type, object ID &ldquo;DNS&rdquo;, object name &ldquo;DNS&rdquo; and an empty array for the object properties.
Even if we return only one object we need to return this into an array since findRelation expects an array.
For this folder we did not need to query the DNS server since there is always this root folder with this name so we can build it statically.</p>
<p>The findAllMicrosoftDNSHost action is a tricky one. We need to list the DNS hosts from somewhere. Since we will be leveraging the PowerShell plug-in to query the DNS host we can list the Powershell hosts that are DNS servers. For this we could run PowerShell commands but here I have adopted another strategy with using a &ldquo;Add a DNS host&rdquo; workflow.</p>
<p>This workflow has an input of type PowerShell host and a scriptable task where we set a custom property &ldquo;dnsHost&rdquo;.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">setCustomProperty</span>(<span style="color:#a6e22e">dnsHost</span>,<span style="color:#e6db74">&#34;dnsHost&#34;</span>,<span style="color:#66d9ef">true</span>);
</code></pre></td></tr></table>
</div>
</div><p>A vRO custom property is a convenient way to set a key, value pair (with the value being any object vRO can handle).</p>
<p>This means that as a pre-requisite we need to have a PowerShell host to the vRO inventory – this takes some configuration on the Windows side that is covered in the PowerShell plug-in guide. Then running the &ldquo;Add DNS host&rdquo; workflow so our DNS plug-in knows it has this host available.</p>
<p>Now let&rsquo;s check the findAllDNSHost actions:
Array/DynamicTypes:Microsoft DNS.host findAllMicrosoftDNSHost(type)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHosts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">getObjectsWithCustomPropertyKey</span>(<span style="color:#e6db74">&#34;dnsHost&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">powershellHosts</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;host&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">name</span>, <span style="color:#66d9ef">new</span> Array());
  <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>()
  <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerSetting | ConvertTo-Json&#39;</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
  } <span style="color:#66d9ef">else</span> {
    <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">serverSetting</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());
    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">properties</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">serverSetting</span>.<span style="color:#a6e22e">CimInstanceProperties</span>) {
      <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span>);
      <span style="color:#75715e">//System.log(properties.Name + &#34; = &#34; + properties.Value);
</span><span style="color:#75715e"></span>    }
  }
  <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">object</span>);
}
</code></pre></td></tr></table>
</div>
</div><p>Server.getObjectsWithCustomPropertyKey basically gets the DNS servers we added with the &ldquo;Add a DNS host&rdquo; workflow.</p>
<p>We are looping through these to create the host objects with makeObject.</p>
<p>We could have returned the resultObjs array at this point but since we have the PowerShell host handy I open a session with powerShellHost.openSession() and run the get-dnsServerSetting command to get some properties.</p>
<p>When running the command I use powerShell ConvertTo-Json to output the result in a format vRO can natively understand. JSON is JavaScript Object Notation, basically a way to describe a JavaScript object as text. With this I just have to do a</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">serverSetting</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>())
</code></pre></td></tr></table>
</div>
</div><p>to get a javascript object that is much more convenient to extract properties</p>
<p>To understand the structure of the JSON file did copy and paste the text output to a JSON viewer such as jsonviewer.stack.nu
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-007.png"/> <figcaption>
            <h4>The DNS server settings opened in a JSON viewer</h4>
        </figcaption>
</figure>
</p>
<p>These DNS cmdlets always have the same format which is very convenient to parse. All object properties are both under the root object as static properties and as an array of CimInstanceProperties allowing to set the object properties with the setProperty method this way:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">properties</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">serverSetting</span>.<span style="color:#a6e22e">CimInstanceProperties</span>) {
  <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span>);
}
</code></pre></td></tr></table>
</div>
</div><p>Finally I close the session with</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>( <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>())
</code></pre></td></tr></table>
</div>
</div><p>The try / catch finally blocks allows to close the session in case of success or failure of the script in the try block.</p>
<p>The cmdlet piped to ConvertTo-Json transformed into a JavaScript Object that we iterate through its properties is the pattern we will use for the other PowerShell objects. We would use the same methodology for other PowerShell integrations.</p>
<h3 id="find-relation-microsoft-dns-host">Find Relation Microsoft DNS-host</h3>
<p>Next we need to be able to unfold the items under the DNS host. For this we need to edit the &ldquo;Find Relation Microsoft DNS-Host&rdquo;
To mimic the Microsoft GUI we will return three folders like this:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">relationName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;host-zones&#34;</span>) {
 <span style="color:#75715e">//Zones types
</span><span style="color:#75715e"></span> <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
 <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">parentId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/forwardLookupZones&#34;</span>, <span style="color:#e6db74">&#34;Forward Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
 <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">parentId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/reverseLookupZones&#34;</span>, <span style="color:#e6db74">&#34;Reverse Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
 <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">parentId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/conditionalForwarders&#34;</span>, <span style="color:#e6db74">&#34;Conditional Forwarders&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
}
</code></pre></td></tr></table>
</div>
</div><p>Note that we always prefix the object ID with the ID of the PowerShell server in order to:</p>
<ul>
<li>Have unique IDs for objects with same ID postfix</li>
<li>Be able to use the PowerShell host ID to get the PowerShell host object to query it</li>
</ul>
<p>This is a very important design implementation that I have successfully used many times when building plug-ins integration REST based hosts.</p>
<p>Next we need to be able to unfold the items under the zones type. For this we need to edit the &ldquo;Find Relation Microsoft DNS-zones&rdquo;</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">relationName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;zones-zone&#34;</span>) {
  <span style="color:#75715e">//Zones types
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parentId</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">0</span>];
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zoneFolderType</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parentId</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>];
  <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;zoneFolderType : &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneFolderType</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">powershellHostId</span>);

  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
  <span style="color:#66d9ef">try</span> {  
    <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>()  
    <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-DnsServerZone | ConvertTo-Json -Compress&#39;</span>);  
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span>  <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>){  
        <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());  
    } <span style="color:#66d9ef">else</span> {
      <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zones</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());
      <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zones</span>) {
        <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>);
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">zoneFolderType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;conditionalForwarders&#34;</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Forwarder&#34;</span>){      
          <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#66d9ef">new</span> Array());
        }
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">zoneFolderType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;forwardLookupZones&#34;</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Primary&#34;</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">IsReverseLookupZone</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span>) {
          <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#66d9ef">new</span> Array());
        }
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">zoneFolderType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;reverseLookupZones&#34;</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneType</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Primary&#34;</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">IsReverseLookupZone</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) {
          <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#66d9ef">new</span> Array());
        }
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">object</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
          <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;ZoneType&#34;</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneType</span>);
          <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;IsAutoCreated&#34;</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">IsAutoCreated</span>);
          <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;IsDsIntegrated&#34;</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">IsDsIntegrated</span>);
          <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;IsReverseLookupZone&#34;</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">IsReverseLookupZone</span>);
          <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">object</span>);
        }
      }
    }
  } <span style="color:#66d9ef">catch</span> ( <span style="color:#a6e22e">ex</span> ) {  
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span> (<span style="color:#a6e22e">ex</span>);  
  } <span style="color:#66d9ef">finally</span> {  
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {  
      <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>( <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());  
    }  
  }
}
</code></pre></td></tr></table>
</div>
</div><p>First we get the powerShell object from the parent ID using the split command then the zoneFolderType that we will use later to filter the different types of zones (Forward, Reverse, conditional)Then we get the PowerSHellHost object using</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">powershellHostId</span>);
</code></pre></td></tr></table>
</div>
</div><p>Then we get all DNS zones and convert the result to JSON with:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-DnsServerZone | ConvertTo-Json -Compress&#39;</span>);
</code></pre></td></tr></table>
</div>
</div><p>Note that I used the Compress parameter. This reduces the amount of space characters in the output which are only useful for having a nice indentation but useless for us as we convert this to a JavaScript object. Compressing will also allow the PowerShell query to run faster which will translate in unfolding the tree view quicker.</p>
<p>Once again we use a JSON viewer to see the output
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-009.png"/> <figcaption>
            <h4>Array of zone objects</h4>
        </figcaption>
</figure>
</p>
<p>The JSON is returned in the form of an array of Zone objects. As for the DNS server settings the properties of the zone object are accessible either via the CimInstanceProperties or directly using the properties name at the root of the object. This time I used the direct properties to check the type of zone so it match the parent folder and its properties.</p>
<p>I made the choice of using the zone name as the zone ID prefix since it will be useful for the next findRelation to know the zone name from the parentId that will be provided when finding the records from the zone names</p>
<h3 id="find-relation-microsoft-dns-zone">Find Relation Microsoft DNS-zone</h3>
<p>The last step to implement is to unfold the records</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">relationName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;zone-resourceRecord&#34;</span>) {
  <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parentId</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">0</span>];
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parentId</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>];
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">powershellHostId</span>);  
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
  <span style="color:#66d9ef">try</span> {
    <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>();  
    <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-DnsServerResourceRecord &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; | ConvertTo-Json -depth 3 -Compress&#39;</span>);  
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span>  <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>){  
        <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());  
      }
      <span style="color:#66d9ef">else</span> { 
      <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecords</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());
      <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecord</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">resourceRecords</span>) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecordProperties</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftDNSObjectProperties</span>(<span style="color:#a6e22e">resourceRecord</span>);
        <span style="color:#75715e">// Adding parent zone name
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;Zone&#34;</span>, <span style="color:#a6e22e">zoneName</span>);
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">resourceRecord</span>.<span style="color:#a6e22e">HostName</span>;
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">name</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;@&#34;</span>) <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;(same as parent folder)&#34;</span>;
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">encodedId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftResourceRecordId</span>(<span style="color:#a6e22e">resourceRecordProperties</span>) ;
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;resourceRecord&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">encodedId</span>, <span style="color:#a6e22e">name</span>, <span style="color:#66d9ef">new</span> Array());

        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">keys</span>) {
          <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">key</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; : &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">key</span>));
          <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">key</span>));
        }
        <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">object</span>);
      }
    }
  } <span style="color:#66d9ef">catch</span> ( <span style="color:#a6e22e">ex</span> ) {  
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span> (<span style="color:#a6e22e">ex</span>);  
  } <span style="color:#66d9ef">finally</span> {  
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {  
        <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>( <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());  
    }
  }
}
</code></pre></td></tr></table>
</div>
</div><p>The pattern here starts in a very similar way the zones find Relation.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#e6db74">&#39;get-DnsServerResourceRecord &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; | ConvertTo-Json -depth 3 -Compress&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>will retrieve an arry of resource records</p>
<p>Please note the &lsquo;-depth3&rsquo; here. ConvertTo-Json default depth is 2 meaning that if you have complex objects under the CimInstanceProperties these will be collapsed to save space which unfortunately in this case result in information loss. By adjusting the Depth to 3 I managed to not loose information anymore. This is a very important aspect when integrating with PowerShell.</p>
<p>Next I am iterating over the resourceRecords and passing these to the getMicrosoftDNSObjectProperties action that basically extract the complex resourceRecord properties in a vRO properties object having all values as strings.</p>
<p>Then I am adding the parent zone name as a property of the resourceRecord object. Knowing a record parent zone will be useful for operations on records next.</p>
<p>Then I have a new strategy here where I am generating a string ID from the resource record properties since there is no properties in the resourceRecord object that is unique. For example you can have 2 records with the same name. Only the combination of all properties is unique so this was the first reason I created this getMicrosoftResourceRecordId action. Please note that this action is using Base64 encoding to make sure the ID only contains valid characters.</p>
<p>The second reason if for reliability and efficiency of the &ldquo;Find Microsoft DNS-resourceRecord By Id&rdquo; workflow we will have to implement next. Since there is no unique ID it is not possible to effectively query a single record and there is the risk, at this leaf level of the tree view of starting a great number of requests on the PowerShell host which may be configured to not accept as many and will result in slow response times.</p>
<p>Now that we are done implementing all the find Relation workflows we can test unfolding the inventory and compare to the Microsoft DNS UI
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-010.png"/> <figcaption>
            <h4>The Microsoft DNS Manager UI reproduced in the Orchestrator inventory</h4>
        </figcaption>
</figure>
</p>
<p>You may notice there are a few more zones in the vRO inventory as the Microsoft UI hide some.</p>
<h2 id="implementing-findall-and-findbyid">Implementing FindAll and findById</h2>
<p>We still need findAll to use drop down lists as input and findById to be able to use a plug-in object within a scriptable task or action.</p>
<p>In order to test these methods with the different types we created we should create some test workflow for each type
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-011.png"/> <figcaption>
            <h4>Test workflows</h4>
        </figcaption>
</figure>
</p>
<p>Each workflow has:</p>
<ul>
<li>One input of the given type.</li>
<li>The presentation property &ldquo;Select value as list&rdquo; -&gt; This will trigger the findAll to display the list</li>
<li>A scriptable task with the input parameter</li>
<li>The following script to check the object name and properties:</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Found object &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dynamicTypeObject</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; with id &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dynamicTypeObject</span>.<span style="color:#a6e22e">id</span>);
<span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;With properties : &#34;</span>);

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span>  <span style="color:#a6e22e">property</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">dynamicTypeObject</span>.<span style="color:#a6e22e">getOrderedPropertyNames</span>()) {
  <span style="color:#66d9ef">try</span> {
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;\t&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">property</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; = &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dynamicTypeObject</span>.<span style="color:#a6e22e">getProperty</span>(<span style="color:#a6e22e">property</span>));
  } <span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">e</span>) {<span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#34;Did not found property &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">property</span>)};  
}
</code></pre></td></tr></table>
</div>
</div><p>I just had to create one and duplicate it with changing the type for each type.</p>
<h3 id="find-all-microsoft-dns-hosts-and-find-all-microsoft-dns-host">Find All Microsoft DNS-hosts&quot; and &ldquo;Find All Microsoft DNS-host</h3>
<p>Since I had already implemented the findAllMicrosoftDNSHost and findAllMicrosoftDNSHosts actions , I just had to call these in the &ldquo;Find All Microsoft DNS-hosts&rdquo; and &ldquo;Find All Microsoft DNS-host&rdquo; workflows</p>
<h3 id="find-all-microsoft-dns-zones">Find All Microsoft DNS-zones</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHosts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">getObjectsWithCustomPropertyKey</span>(<span style="color:#e6db74">&#34;dnsHost&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
  
<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">powershellHosts</span>) {
  <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/forwardLookupZones&#34;</span>, <span style="color:#e6db74">&#34;Forward Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
  <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/reverseLookupZones&#34;</span>, <span style="color:#e6db74">&#34;Reverse Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
  <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/conditionalForwarders&#34;</span>, <span style="color:#e6db74">&#34;Conditional Forwarders&#34;</span>, <span style="color:#66d9ef">new</span> Array()));
}
</code></pre></td></tr></table>
</div>
</div><p>Is pretty much a copy of the code we used for &ldquo;Find Relation Microsoft DNS-host&rdquo; except we do it for each DNS host</p>
<h3 id="find-all-microsoft-dns-zone">Find All Microsoft DNS-zone</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHosts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">getObjectsWithCustomPropertyKey</span>(<span style="color:#e6db74">&#34;dnsHost&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">powershellHosts</span>) {
    <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
    <span style="color:#66d9ef">try</span> {
        <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>()
        <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerZone| ConvertTo-Json -depth 3 -Compress&#39;</span>);
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
            <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zones</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());

            <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zones</span>) {
                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
                <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#66d9ef">new</span> Array());

        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">properties</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">CimInstanceProperties</span>) {
          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#e6db74">&#34;&#34;</span>);
          <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span>);
          <span style="color:#75715e">//System.log(properties.Name + &#34; = &#34; + properties.Value);  
</span><span style="color:#75715e"></span>        }
        <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">object</span>);
      }
        }
    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">ex</span>) {
        <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ex</span>);
    } <span style="color:#66d9ef">finally</span> {
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {
            <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>(<span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());
        }
    }
}
</code></pre></td></tr></table>
</div>
</div><p>Is very similar than the &ldquo;Find Relation Microsoft DNS-zones&rdquo; except we do not have to filter by zone type and that I am iterating over the CimInstanceProperties to set the properties dynamically.</p>
<h3 id="find-all-microsoft-dns-resourcerecord">Find All Microsoft DNS-resourceRecord</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHosts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">getObjectsWithCustomPropertyKey</span>(<span style="color:#e6db74">&#34;dnsHost&#34;</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();

<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">powershellHosts</span>) {
  <span style="color:#a6e22e">resultObjs</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Array();
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
  <span style="color:#66d9ef">try</span> {
    <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>();
    <span style="color:#75715e">// We get the zones first instead of piping them since we want the zone to be a property of the object
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerZone | ConvertTo-Json -depth 1 -Compress&#39;</span>);

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
      <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
    } <span style="color:#66d9ef">else</span> {

      <span style="color:#75715e">//System.log(invResult.getHostOutput() );
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zones</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());

      <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zones</span>) {
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>;
        <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerResourceRecord &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; | ConvertTo-Json -depth 3 -Compress&#39;</span>); <span style="color:#75715e">//3 required to get proper recordData
</span><span style="color:#75715e"></span>
        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
          <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
        } <span style="color:#66d9ef">else</span> {
          <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>          <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecords</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());

          <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecord</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">resourceRecords</span>) {            
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecordProperties</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftDNSObjectProperties</span>(<span style="color:#a6e22e">resourceRecord</span>);
            <span style="color:#75715e">// Adding parent zone name
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;Zone&#34;</span>, <span style="color:#a6e22e">zoneName</span>);
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">resourceRecord</span>.<span style="color:#a6e22e">HostName</span>;
            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">name</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;@&#34;</span>) <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;(same as parent folder)&#34;</span>;
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">encodedId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftResourceRecordId</span>(<span style="color:#a6e22e">resourceRecordProperties</span>) ;
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;resourceRecord&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">encodedId</span>, <span style="color:#a6e22e">name</span>, <span style="color:#66d9ef">new</span> Array());

            <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">keys</span>) {
              <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">key</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; : &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">key</span>));
              <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">resourceRecordProperties</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">key</span>));
            }
            <span style="color:#a6e22e">resultObjs</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">object</span>);
          }
        }
      }
    }
  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">ex</span>) {
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ex</span>);
  } <span style="color:#66d9ef">finally</span> {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {
      <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>(<span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());
    }
  }
}
</code></pre></td></tr></table>
</div>
</div><p>The scripting is very similar to &ldquo;Find All Microsoft DNS-zone&rdquo;. The difference is that we make two PowerShell calls : one for the zones and one for the records since we must provide a zone for the get-dnsServerResourceRecord cmdlet. At first I managed it in a single call where I piped the zones but since I want to add a zone property for each record this was not working since the zone is not a property of the resource Record. Then I am generating the ID with the resourceRcord properties as explained before.</p>
<h3 id="find-microsoft-dns-hosts-by-id">Find Microsoft DNS-hosts By Id</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span>  <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;hosts&#34;</span>, <span style="color:#e6db74">&#34;DNS&#34;</span>, <span style="color:#e6db74">&#34;DNS&#34;</span>, <span style="color:#66d9ef">new</span> Array());
</code></pre></td></tr></table>
</div>
</div><p>Straight forward and certainly useless since we will certainly never us the DNS-Hosts folder as input of any workflow.</p>
<h3 id="find-microsoft-dns-host-by-id">Find Microsoft DNS-host By Id</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">id</span>);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;host&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">name</span>, <span style="color:#66d9ef">new</span> Array());
    <span style="color:#66d9ef">try</span> {
        <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>()
        <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerSetting | ConvertTo-Json&#39;</span>);

        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
            <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">serverSetting</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());
            <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">properties</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">serverSetting</span>.<span style="color:#a6e22e">CimInstanceProperties</span>) {
                <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span>);
                <span style="color:#75715e">//System.log(properties.Name + &#34; = &#34; + properties.Value);  
</span><span style="color:#75715e"></span>            }
        }
    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">ex</span>) {
        <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ex</span>);
    } <span style="color:#66d9ef">finally</span> {
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {
            <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>(<span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());

        }
    }
}
</code></pre></td></tr></table>
</div>
</div><p>Same code as already completed except we query a single DNS host to gets its property settings.I could put this in an action to call it from the find All Microsoft DNS Host workflow.</p>
<h3 id="find-microsoft-dns-zones-by-id">Find Microsoft DNS-zones By Id</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>]) {
  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;forwardLookupZones&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#e6db74">&#34;Forward Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()); <span style="color:#66d9ef">break</span>;
  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;reverseLookupZones&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#e6db74">&#34;Reverse Lookup Zones&#34;</span>, <span style="color:#66d9ef">new</span> Array()); <span style="color:#66d9ef">break</span>;
  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;conditionalForwarders&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#e6db74">&#34;Conditional Forwarders&#34;</span>, <span style="color:#66d9ef">new</span> Array()); <span style="color:#66d9ef">break</span>;
}
</code></pre></td></tr></table>
</div>
</div><p>Again very similar to the find All method.</p>
<h3 id="find-microsoft-dns-zone-by-id">Find Microsoft DNS-zone By Id</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">0</span>]);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
  <span style="color:#66d9ef">try</span> {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>];
    <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>();
    <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#e6db74">&#39;get-dnsServerZone &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; | ConvertTo-Json&#39;</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
      <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>());
    } <span style="color:#66d9ef">else</span> {
      <span style="color:#75715e">//System.log( invResult.getHostOutput() );
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>());
      <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">ZoneName</span>, <span style="color:#66d9ef">new</span> Array());

      <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">properties</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">CimInstanceProperties</span>) {
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#e6db74">&#34;&#34;</span>);
        <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">properties</span>.<span style="color:#a6e22e">Value</span>);
        <span style="color:#75715e">//System.log(properties.Name + &#34; = &#34; + properties.Value);  
</span><span style="color:#75715e"></span>      }
    }
  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">ex</span>) {
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ex</span>);
  } <span style="color:#66d9ef">finally</span> {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {
      <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>(<span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());
    }
  }
  <span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
}
</code></pre></td></tr></table>
</div>
</div><p>Here we leverage the fact we used the zone name as the ID. This allows passing it to get-dnsServerZone and get all the object properties.</p>
<h3 id="find-microsoft-dns-resourcerecord-by-id">Find Microsoft DNS-resourceRecord By Id</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Base64</span> <span style="color:#f92672">=</span> {

  <span style="color:#75715e">// private property
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">_keyStr</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#34;</span>,

  <span style="color:#75715e">// public method for decoding
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">decode</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">input</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">chr1</span>, <span style="color:#a6e22e">chr2</span>, <span style="color:#a6e22e">chr3</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">enc1</span>, <span style="color:#a6e22e">enc2</span>, <span style="color:#a6e22e">enc3</span>, <span style="color:#a6e22e">enc4</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

    <span style="color:#a6e22e">input</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/[^A-Za-z0-9\+\/\=]/g</span>, <span style="color:#e6db74">&#34;&#34;</span>);

    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">length</span>) {

      <span style="color:#a6e22e">enc1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_keyStr</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>));
      <span style="color:#a6e22e">enc2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_keyStr</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>));
      <span style="color:#a6e22e">enc3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_keyStr</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>));
      <span style="color:#a6e22e">enc4</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_keyStr</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>));

      <span style="color:#a6e22e">chr1</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">enc1</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">2</span>) <span style="color:#f92672">|</span> (<span style="color:#a6e22e">enc2</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gt</span>; <span style="color:#ae81ff">4</span>);
      <span style="color:#a6e22e">chr2</span> <span style="color:#f92672">=</span> ((<span style="color:#a6e22e">enc2</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">15</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">4</span>) <span style="color:#f92672">|</span> (<span style="color:#a6e22e">enc3</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gt</span>; <span style="color:#ae81ff">2</span>);
      <span style="color:#a6e22e">chr3</span> <span style="color:#f92672">=</span> ((<span style="color:#a6e22e">enc3</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">3</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">6</span>) <span style="color:#f92672">|</span> <span style="color:#a6e22e">enc4</span>;

      <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">chr1</span>);

      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">enc3</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">64</span>) {
        <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">chr2</span>);
      }
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">enc4</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">64</span>) {
        <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">chr3</span>);
      }
    }

    <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Base64</span>.<span style="color:#a6e22e">_utf8_decode</span>(<span style="color:#a6e22e">output</span>);

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">output</span>;
  },

  <span style="color:#75715e">// private method for UTF-8 decoding
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">_utf8_decode</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">utftext</span>) {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">string</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">c2</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#a6e22e">utftext</span>.<span style="color:#a6e22e">length</span>) {

      <span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">utftext</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>);

      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">128</span>) {
        <span style="color:#a6e22e">string</span> <span style="color:#f92672">+=</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">c</span>);
        <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ((<span style="color:#a6e22e">c</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">gt</span>; <span style="color:#ae81ff">191</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; (<span style="color:#a6e22e">c</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">224</span>)) {
        <span style="color:#a6e22e">c2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">utftext</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
        <span style="color:#a6e22e">string</span> <span style="color:#f92672">+=</span> String.<span style="color:#a6e22e">fromCharCode</span>(((<span style="color:#a6e22e">c</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">31</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">6</span>) <span style="color:#f92672">|</span> (<span style="color:#a6e22e">c2</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">63</span>));
        <span style="color:#a6e22e">i</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#a6e22e">c2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">utftext</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
        <span style="color:#a6e22e">c3</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">utftext</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);
        <span style="color:#a6e22e">string</span> <span style="color:#f92672">+=</span> String.<span style="color:#a6e22e">fromCharCode</span>(((<span style="color:#a6e22e">c</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">15</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">12</span>) <span style="color:#f92672">|</span> ((<span style="color:#a6e22e">c2</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">63</span>) <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>; <span style="color:#ae81ff">6</span>) <span style="color:#f92672">|</span> (<span style="color:#a6e22e">c3</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">amp</span>; <span style="color:#ae81ff">63</span>));
        <span style="color:#a6e22e">i</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">3</span>;
      }
    }

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">string</span>;
  }
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">decodedId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Base64</span>.<span style="color:#a6e22e">decode</span>(<span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">1</span>]);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecord</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">decodedId</span>);
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">object</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">makeObject</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;resourceRecord&#34;</span>, <span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">resourceRecord</span>.<span style="color:#a6e22e">HostName</span>, <span style="color:#66d9ef">new</span> Array());

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">idObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">decodedId</span>);

<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">propertyName</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">idObj</span>) {
  <span style="color:#75715e">//System.log(&#34;*** PropertyName : &#34; + propertyName); 
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">object</span>.<span style="color:#a6e22e">setProperty</span>(<span style="color:#a6e22e">propertyName</span>, <span style="color:#a6e22e">idObj</span>[<span style="color:#a6e22e">propertyName</span>]);
}

<span style="color:#a6e22e">resultObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">object</span>;
</code></pre></td></tr></table>
</div>
</div><p>Here is the most complex action. First we define a base 64 decode function. Then we use it to decode the ID as a JSON string representing the resource record. Then we use the resourceRecord JavaScript object to get its properties. This way we can manage to extract all properties without ever querying the DNS server for the information. It is a good way to avoid a lot of queries and reliability issues when there are different rcords for the same record name. The drawback is that these properties are as old as the findRelation or findAll call that created the ID for the resourceRecord.</p>
<h2 id="creating-plug-in-action-methods">Creating plug-in action methods</h2>
<p>At this point we do have a functioning plug-in but while using workflows for development is convenient to understand when they are called and check they run properly it has some important drawbacks for an Orchestrator running in production. Plug-in methods can be called hundreds of times in minutes if not seconds. This is the case if you use an array of DynamicType objects that get iterated in the workflow. Running a workflow instead of an action has a lot of overhead. It will store many workflow runs in the Orchestrator database very quickly.The way to avoid that is to convert all workflows to actions and edit the types so their methods call actions instead of workflows. This will immediately have an great impact on the performance as well in the order of 10 to 20 times faster.So the first thing is to create all the actions in a scripting module and add the same inputs / ouptuts as in the workflows. Then copy paste the workflow scriptable task and not forget to return the result.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-012.png"/> <figcaption>
            <h4>Plug-in action methods</h4>
        </figcaption>
</figure>
</p>
<p>If you check the &ldquo;Update type&rdquo; workflow you will notice it does not provide you with the option to change the worflow stubs to actions. This leaves us with exporting the Dynamic Types configuration, edit it and import it back again.You can export all the Dynamic Types configuration with saving to file the resource element under Library / DynamicTypes / Configuration
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-013.png"/> <figcaption>
            <h4>Save the Dynamic Types configuration to a file</h4>
        </figcaption>
</figure>
</p>
<p>Once saved you should always make a copy of it in case you make some unwanted / unsupported changes. It is easier to update it with the copy instead of editing it back.Open it in a text editor. For each object change the findByIdBinding, findAllBinding, hasChildrenInrelationBinding, findRelationBinding values from the workflow ID to the path of the scripting module and action name.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-014.png"/> <figcaption>
            <h4>Bindings updated with actions</h4>
        </figcaption>
</figure>
</p>
<p>Once all types updated you can save and update the resource
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-015.png"/> <figcaption>
            <h4>Updating the Dynamic Types configuration</h4>
        </figcaption>
</figure>
</p>
<p>You can also use this method to do all your types icons, properties, relation changes or even create types.You should immediately feel a speed up when unfolding the inventory of using a list as input.</p>
<p>Providing CRUD workflowsNow that we have a functioning plug-in we will provide the end user with some functionality with some workflows to create, update / operate and delete DNS zones and records.</p>
<h3 id="powershell-workflows">PowerShell workflows</h3>
<p>To do so I first created these workflows with using the PowerShell host as input.</p>
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-016.png"/> <figcaption>
            <h4>PowerShell workflows</h4>
        </figcaption>
</figure>

<p>Each of this workflow is written with the same scriptable task except for the PowerShell command and its parameters and matching workflow input parameters.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">sess</span>;
  <span style="color:#66d9ef">try</span> {
    <span style="color:#a6e22e">sess</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">openSession</span>();
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">command</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Add-DnsServerResourceRecordA -Name &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; -ZoneName &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span>;

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">allowUpdateAny</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) <span style="color:#a6e22e">command</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39; -AllowUpdateAny &#39;</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">createPtr</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">true</span>) <span style="color:#a6e22e">command</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39; -CreatePtr &#39;</span>;
    <span style="color:#a6e22e">command</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">ipAddress</span>;
    <span style="color:#a6e22e">command</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39; -PassThru&#39;</span>
    <span style="color:#a6e22e">command</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39; | ConvertTo-Json -Compress&#39;</span>;
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">command</span>);
    <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">addCommandFromString</span>(<span style="color:#a6e22e">command</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">invResult</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">invokePipeline</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">invocationState</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Failed&#39;</span>) {
      <span style="color:#a6e22e">success</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
      <span style="color:#a6e22e">errorCode</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getErrors</span>().<span style="color:#a6e22e">toString</span>();
    } <span style="color:#66d9ef">else</span> {
      <span style="color:#a6e22e">success</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
      <span style="color:#75715e">//System.log(invResult.getHostOutput());
</span><span style="color:#75715e"></span>      <span style="color:#a6e22e">jsonOutput</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">invResult</span>.<span style="color:#a6e22e">getHostOutput</span>();
    }
  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">ex</span>) {
    <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ex</span>);
  } <span style="color:#66d9ef">finally</span> {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sess</span>) {
      <span style="color:#a6e22e">powershellHost</span>.<span style="color:#a6e22e">closeSession</span>(<span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">getSessionId</span>());
    }
  }
} 
</code></pre></td></tr></table>
</div>
</div><p>The scripting goes like this:</p>
<ul>
<li>Opening a session on the PowerShell host coming from the workflow input</li>
<li>Creating the command string with the mandatory inputs.</li>
<li>Adding the optional inputs that I have set as boolean inputs in the workflow</li>
<li>Adding the Passthru option : This is what tells Powershell to return the object it just created.</li>
<li>Piping the result to ConvertTo-Json with the compress option</li>
<li>Assigning the JSON string as the output of the workflow</li>
<li>Finally closing the session</li>
</ul>
<p>The delete workflows will not use the passThru since it does not need the objectIn terms of presentation the manfatory command parameters are set as mandatory inputs and the PowerShell host is set with &ldquo;Show in inventory&rdquo; so we can right click / run these workflows on the PowerShell host.</p>
<h3 id="plug-in-workflows">Plug-in workflows</h3>
<p>For each PowerShell workflow I have created a matching workflow using plug-in types as inputs and outputs.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-017.png"/> <figcaption>
            <h4>Plug-in workflows</h4>
        </figcaption>
</figure>
</p>
<p>Each of thse workflows is designed with the same patern:</p>
<ul>
<li>The first scriptable task sets the powerShell host and may also get plug-in objects properties required for the PowerShell workflow</li>
<li>The PowerShell workflow runs and sets the JSON output</li>
<li>The Last scriptable tasks find and output the object from its ID and invalidates its parent object to refresh the inventory. In case of a delete operation no object need to be found.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-018.png"/> <figcaption>
            <h4>Plug-in workflows steps</h4>
        </figcaption>
</figure>
</li>
</ul>
<p>Example 1 : &ldquo;Add forward Primary zone&quot;Getting the PowerShell host from the dnsHost object ID:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dnsHost</span>.<span style="color:#a6e22e">id</span>;
<span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">powershellHostId</span>);
</code></pre></td></tr></table>
</div>
</div><p>Getting the zone object with its ID based on PowerShell host ID prefix and zone Name postfix, then ivalidating its parent object.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">zone</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;DynamicTypes:Microsoft DNS.zone&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">name</span>);
<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">invalidate</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zones&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/forwardLookupZones&#34;</span>);
</code></pre></td></tr></table>
</div>
</div><p>Example 2 : &ldquo;Add an alias (CNAME)&ldquo;Getting the PowerShell host form the record ID prefix and setting PowerShell workflow input parameters from the record object properties:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">0</span>];
<span style="color:#a6e22e">powershellHost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;PowerShell:PowerShellHost&#34;</span>, <span style="color:#a6e22e">powershellHostId</span>);
<span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">Zone</span>;
<span style="color:#a6e22e">hostNameAlias</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span>;
</code></pre></td></tr></table>
</div>
</div><p>Getting the newly record object with generating its ID from the JSON output , then ivalidating its parent object.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">///The record id is made with the object properties that are encoded to make sure they do not contain any character not accepted in an ID
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecordProperties</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftDNSObjectProperties</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">jsonOutput</span>));

<span style="color:#75715e">// Generating the second part of the ID from the properties
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">resourceRecordId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftResourceRecordId</span>(<span style="color:#a6e22e">resourceRecordProperties</span>);

<span style="color:#a6e22e">resourceRecord</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;DynamicTypes:Microsoft DNS.resourceRecord&#34;</span>, <span style="color:#a6e22e">powershellHostId</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">resourceRecordId</span>);
<span style="color:#a6e22e">DynamicTypesManager</span>.<span style="color:#a6e22e">invalidate</span>(<span style="color:#e6db74">&#34;Microsoft DNS&#34;</span>, <span style="color:#e6db74">&#34;zone&#34;</span>, <span style="color:#a6e22e">zoneName</span>);
</code></pre></td></tr></table>
</div>
</div><p>With this design the plug-in can be extended with other PowerShell commands mapping to plug-in workflows.</p>
<h2 id="xaas">XaaS</h2>
<p>Now that we have a plug-in we can create a new custom resource and use its CRUD workflows as a service.</p>
<h3 id="custom-resource">Custom resource</h3>
<p>The first step is to add a new custom resource in vRA. This basically maps a resource Name in vRA to a plug-in object in vRO.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-027.png"/> <figcaption>
            <h4>Custom resource</h4>
        </figcaption>
</figure>
</p>
<h3 id="xaas-blueprint">XaaS blueprint</h3>
<p>To be able to request a DNS record the next step is to add an XaaS Blueprint using &ldquo;Add a DNS host (A) workflow
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-020.png"/> <figcaption>
            <h4>Auto generated Blueprint form</h4>
        </figcaption>
</figure>
</p>
<p>A part from selecting the workflow you need to set the Provisioned Resource to &ldquo;DNS Host&rdquo; 
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-021.png"/> <figcaption>
            <h4>Setting the Provisioned resource in the XaaS blueprint</h4>
        </figcaption>
</figure>
</p>
<p>Once created, published and entitled you can test requesting a new DNS record from the catalog. You can customize the icon in Administration / Catalog Items</p>
<h3 id="testing-the-dns-hort-record-request">Testing the DNS hort record request</h3>
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-022.png"/> <figcaption>
            <h4>Add a DNS host catalog item</h4>
        </figcaption>
</figure>

<p>You will have to provide a zone, a name and IP address and if you want to create the PTR record and allow updates.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-023.png"/> <figcaption>
            <h4>New Request</h4>
        </figcaption>
</figure>
</p>
<p>A few seconds later you get a new DNS entry that is under the Itams / Dynamic Types tab
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-024.png"/> <figcaption>
            <h4>New DNS host record item provisioned</h4>
        </figcaption>
</figure>
</p>
<h3 id="resource-action">Resource action</h3>
<p>You can also add an action to Remove the record that maps to the &ldquo;Remove a resource record&rdquo; workflow. The important part here is to indicate this is a disposal type of action so vRA will remove the item once the workflow has been successfully ran.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-025.png"/> <figcaption>
            <h4>Resource action with disposal option</h4>
        </figcaption>
</figure>
</p>
<h3 id="testing-the-remove-a-dns-host-record-action">Testing the Remove a DNS host record action</h3>
<p>Then you can test the removal action from the items tab.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-026.png"/> <figcaption>
            <h4>Remove a DNS Host</h4>
        </figcaption>
</figure>
</p>
<p>You now successfully manage the lifecycle of DNS host records within vRA with kepping records on who requested / removed a record and having end users managing this on their own.It is nice but does offer a lot of freedom on what IP and host name. We can automate further using an XaaS component</p>
<h2 id="software-blueprint-including-dns-xaas-component">Software blueprint including DNS XaaS component</h2>
<p>Now that we have XaaS components we can make these part of a software blueprint so DNS records can be created on the fly at deployment time, being displayed as part of a deployment component and deleted with the deployment. This basicly means we will manage the lifecycle of the application and the DNS record as one.</p>
<h3 id="xaas-component-workflow">XaaS component workflow</h3>
<p>The first requirement is to be able to start the workflow adding the record from the deployment. This is done by adding the XaaS Blueprint to the software Blueprint. However we cannot just use our existing XaaS blueprint since the designer passes the blueprint output fileds such as IP address and host name has an array of strings in a JSON format.To use with the designer I have created a wrapper workflow converting JSON inputs as the name and IP string that calls our &ldquo;Add a host (A)&rdquo; plug-in workflow. I have also added a zone drop down using strings instead of array of zones since vRA has an issue listing array of Dynamic Types.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-028.png"/> <figcaption>
            <h4>Workflow wrapper for XaaS blueprint component</h4>
        </figcaption>
</figure>
</p>
<p>The scriptable task in the workflow contains the following:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ips</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">ipJson</span>);
<span style="color:#a6e22e">ipAddress</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ips</span>[<span style="color:#ae81ff">0</span>];
<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">names</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">nameJson</span>);
<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">names</span>[<span style="color:#ae81ff">0</span>];

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hosts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findAllForType</span>(<span style="color:#e6db74">&#34;DynamicTypes:Microsoft DNS.host&#34;</span>);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hosts</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">zone</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Server</span>.<span style="color:#a6e22e">findForType</span>(<span style="color:#e6db74">&#34;DynamicTypes:Microsoft DNS.zone&#34;</span>, <span style="color:#a6e22e">hosts</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">id</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">zoneName</span>);
<span style="color:#66d9ef">else</span> {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zones</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">System</span>.<span style="color:#a6e22e">getModule</span>(<span style="color:#e6db74">&#34;com.vmware.coe.microsoft.dns.dt&#34;</span>).<span style="color:#a6e22e">getMicrosoftDNSForwardZones</span>();
  <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">each</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zone</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">zones</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">zone</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">zoneName</span>) <span style="color:#66d9ef">break</span>;
  }  
}
</code></pre></td></tr></table>
</div>
</div><p>At first we get the ipAddress and name from the JSON output. This is done using JSON.parse which will return an array which in my case will have a single element.The second part is to create a zone attribute from the zone string input to pass it to the add a host (A) workflow.For the end user confort I have also created an action that get all the Forward zones and return these as an array that I use with the presentation properties &ldquo;Predefined list of elements&quot;Finally I place this wotkflow in an XaaS components folder so I can identify the workflows in there as being designed for being used as XaaS components.</p>
<h3 id="xaas-host-service-blueprint">XaaS host service blueprint</h3>
<p>Now that we have a workflow that can be used by the designer we can add it as a new XaaS blueprint. The important part here is the &ldquo;Make available as a component in the design canvas&rdquo;
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-029.png"/> <figcaption>
            <h4>XaaS blueprint for XaaS component</h4>
        </figcaption>
</figure>
</p>
<p>The next important thing to set is the provisioned resource and the component lifecycle tab.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-031.png"/> <figcaption>
            <h4>XaaS component lifecycle</h4>
        </figcaption>
</figure>
</p>
<p>Here we set the Destroy workflow so whenever the deployment gets destroyed the record will be deleted as well.</p>
<h3 id="adding-the-xaas-component-in-the-software-blueprint">Adding the XaaS component in the software blueprint</h3>
<p>Next we need to edit our software blueprint(s) to include the DNS XaaS component. For this we drag and drop the XaaS component we created on the schema and for the ipJson and nameJson switch to the advanced view to define the value as fields from the blueprint output (IP address and Blueprint Name)
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-030.png"/> <figcaption>
            <h4>Binding the blueprint IP and host name outputs to the XaaS component inputs</h4>
        </figcaption>
</figure>
</p>
<h3 id="testing-the-software-blueprint-with-xaas-component">Testing the software blueprint with XaaS component</h3>
<p>We can now request our software blueprint with the DNS host record component. Note that the name and address fields are not shown to the end user since we bound them to the software blueprint. The end user here will select the zone, and the record option. In production we would likely have set constants defaults for these in the software blueprint designer. This screenshot also show the drop down I created for the zones list.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-033.png"/> <figcaption>
            <h4>Software blueprint with XaaS DNS host record component</h4>
        </figcaption>
</figure>
</p>
<p>After we request this blueprint we get a new deployment that include the DNS record.
<figure>
    <img src="/images/christophe-articles-dd23/DNS-plugin-032.png"/> <figcaption>
            <h4>Deployment including the DNS host record</h4>
        </figcaption>
</figure>
</p>
<p>And when we destroy the deplyment the DNS record get deleted.Using XaaS component as part of the blueprint allows to manage the deployed hosts and their DNS record in one deployment. We could also add resource actions to operate the XaaS component within the deployment. This is a powerfull way to avoid having two different processes to manage the application and the DNS record which often result in having DNS records still existing but unused.</p>
<h2 id="conclusion">Conclusion</h2>
<p>This is quite an extensive tutorial since I have included all major steps including scripting to develop the whole integration from scratch. However <a href="https://code.vmware.com/samples?id=3159"  target="_blank" rel="noreferrer noopener" >I am sharing the Dynamic Types plug-in I have created</a> so you can use it without having to create your own and learn from it, eventually improve it or create other integrations.</p>

    </div>
    <footer class="post__footer">
      
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/plug-in/" rel="tag">plug-in</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/vrealize-automation/" rel="tag">vRealize Automation</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/dns/" rel="tag">DNS</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/microsoft/" rel="tag">Microsoft</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/vra-7.x/" rel="tag">vRA 7.x</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/vro-7.x/" rel="tag">vRO 7.x</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/vrealize-orchestrator/" rel="tag">vRealize Orchestrator</a>
		</li>
	</ul>
</div>
    </footer>
  </article>
</main>

  
  
  <div class="authorbox clearfix">
    <figure class="authorbox__avatar">
      <img alt="Christophe Decanini avatar" src="/images/authors/christophe.jpg" class="avatar" height="150" width="150">
    </figure>
    <div class="authorbox__header">
      <span class="authorbox__name"></span>
    </div>
    <div class="authorbox__description">
      Christophe has worked at VMware, Inc., where he started in 2007 after VMware acquired Dunes. Based in Gland, Switzerland, Christophe is a global resource supporting customers in their orchestration and automation needs. He has presented orchestration solutions at conferences such as VMworld and is the primary contributor to this site.
    </div>
    <div class="widget-social__item widget__item">
      <a class="widget-social__link widget__link btn" title="Twitter" rel="noopener noreferrer"
        href="https://twitter.com/cdecanini_" target="_blank">
        <svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
      </a>
    </div>
  </div>
  


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/articles/learn-vco/322-how-to-update-a-resource-element-script-s-contents-using-curl.html" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">How to update a Resource Element Script&#39;s Contents using curl</p>
		</a>
	</div>
</nav>



			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q" aria-label="SEARCH...">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://www.vcoteam.info/" />
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/articles/synthesis.html">An Honest review of the TTS Service Synthesys</a></li>
			<li class="widget__item"><a class="widget__link" href="/articles/326-building-a-kubernetes-blueprint-for-vra-intro.html">Building a Kubernetes Blueprint for vRealize Automation - Intro</a></li>
			<li class="widget__item"><a class="widget__link" href="/articles/home-lab/325-lightweight-dns-server-for-home-or-test-lab.html">Lightweight DNS Server for Home or Test Lab</a></li>
			<li class="widget__item"><a class="widget__link" href="/articles/newsflash/324-please-share-your-code-at-the-sample-exchange.html">Please share your code at the Sample Exchange</a></li>
			<li class="widget__item"><a class="widget__link" href="/articles/learn-vco/323-how-to-create-a-microsoft-dns-dynamic-types-plug-in.html">How to create a Microsoft DNS Dynamic Types plug-in ?</a></li>
		</ul>
	</div>
</div>
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">Social</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Twitter" rel="noopener noreferrer" href="https://twitter.com/vcoteam" target="_blank">
				<svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
				<span>Twitter</span>
			</a>
		</div>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/ad.html" title="AD">AD (8)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/amqp.html" title="AMQP">AMQP (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/api.html" title="API">API (7)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/blueprint.html" title="Blueprint">Blueprint (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/book.html" title="Book">Book (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/bootable-usb.html" title="bootable usb">bootable usb (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cifs.html" title="CIFS">CIFS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cim.html" title="CIM">CIM (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/container.html" title="Container">Container (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/coredns.html" title="CoreDNS">CoreDNS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/curl.html" title="curl">curl (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dns.html" title="DNS">DNS (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/docker.html" title="docker">docker (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/docker-compose.html" title="docker-compose">docker-compose (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/domain.html" title="Domain">Domain (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dynamictypes.html" title="DynamicTypes">DynamicTypes (10)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/esxi.html" title="ESXi">ESXi (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/excel.html" title="Excel">Excel (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/f5-networks.html" title="F5 Networks">F5 Networks (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/github.html" title="github">github (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hackathon.html" title="Hackathon">Hackathon (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/homelab.html" title="homelab">homelab (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/horizon.html" title="Horizon">Horizon (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/http.html" title="http">http (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/iaas.html" title="IaaS">IaaS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/infoblox.html" title="Infoblox">Infoblox (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/json.html" title="json">json (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/kubernetes.html" title="Kubernetes">Kubernetes (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/lab.html" title="Lab">Lab (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/labmanager.html" title="LabManager">LabManager (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/lcm.html" title="LCM">LCM (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/linux.html" title="linux">linux (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/log.html" title="log">log (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsoft.html" title="Microsoft">Microsoft (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/netapp.html" title="NetApp">NetApp (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/networkmanager.html" title="networkManager">networkManager (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nmcli.html" title="nmcli">nmcli (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nsx.html" title="NSX">NSX (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nuc.html" title="NUC">NUC (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/onyx.html" title="Onyx">Onyx (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/perl.html" title="perl">perl (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/persepctives.html" title="Persepctives">Persepctives (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/plug-in.html" title="Plug-in">Plug-in (38)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/plug-ins.html" title="plug-ins">plug-ins (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/postman.html" title="postman">postman (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/powercli.html" title="PowerCLI">PowerCLI (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/powershell.html" title="PowerShell">PowerShell (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/presentation.html" title="presentation">presentation (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python.html" title="python">python (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rest.html" title="REST">REST (11)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/review.html" title="Review">Review (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/saas.html" title="SaaS">SaaS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/snmp.html" title="SNMP">SNMP (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/soap.html" title="SOAP">SOAP (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/sql.html" title="SQL">SQL (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssl.html" title="SSL">SSL (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/storage-i/o.html" title="Storage I/O">Storage I/O (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/swagger.html" title="Swagger">Swagger (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tts.html" title="TTS">TTS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/twitter.html" title="Twitter">Twitter (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ucs.html" title="UCS">UCS (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/uim.html" title="UIM">UIM (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vapi.html" title="vAPI">vAPI (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcac.html" title="vCAC">vCAC (11)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcap.html" title="vCAP">vCAP (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcat.html" title="vCAT">vCAT (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcd.html" title="vCD">vCD (21)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcenter.html" title="vCenter">vCenter (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcenter-orchestrator.html" title="vCenter Orchestrator">vCenter Orchestrator (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vchs.html" title="vCHS">vCHS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcloud-director.html" title="vCloud Director">vCloud Director (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vcm.html" title="vCM">vCM (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vco.html" title="vCO">vCO (139)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vix.html" title="VIX">VIX (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vmworld.html" title="VMworld">VMworld (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vra.html" title="vRA">vRA (6)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vra-7.x.html" title="vRA 7.x">vRA 7.x (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vrealize-automation.html" title="vRealize Automation">vRealize Automation (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vrealize-orchestrator.html" title="vRealize Orchestrator">vRealize Orchestrator (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vro.html" title="vRO">vRO (17)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vro-7.x.html" title="vRO 7.x">vRO 7.x (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vsan.html" title="vSAN">vSAN (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vshield.html" title="vShield">vShield (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vsm.html" title="VSM">VSM (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vsphere.html" title="vSphere">vSphere (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vum.html" title="VUM">VUM (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/workflow.html" title="workflow">workflow (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/xaas.html" title="XaaS">XaaS (1)</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 vCO Team.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>